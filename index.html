<!DOCTYPE html>
<html>
<head>
  <title>LIFF App</title>
  <script src="https://static.line-scdn.net/liff/edge/2.1/liff.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
    }
    h1 {
      color: #00b900; /* LINE Green */
    }
    button {
      background-color: #00b900; /* LINE Green */
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 4px;
      margin-top: 20px;
    }
    button:hover {
      background-color: #00a000;
    }
    #statusMessage {
      margin-top: 15px;
      padding: 10px;
      border-radius: 4px;
      background-color: #f0f0f0;
      min-height: 20px;
    }
    .success {
      background-color: #d4edda;
      color: #155724;
    }
    .error {
      background-color: #f8d7da;
      color: #721c24;
    }
    .info {
      background-color: #d1ecf1;
      color: #0c5460;
    }
  </style>
</head>
<body>
  <h1>LIFF App</h1>
  <p>点击下方按钮打开 LIFF 并记录到 Sheet3</p>
  <button id="openLiffButton">打开 LIFF</button>
  <div id="statusMessage"></div>
  <script>
    function showStatus(message, isError = false, isSuccess = false) {
      const statusElement = document.getElementById('statusMessage');
      statusElement.textContent = message;
      statusElement.className = '';
      if (isError) {
        statusElement.classList.add('error');
      } else if (isSuccess) {
        statusElement.classList.add('success');
      } else {
        statusElement.classList.add('info');
      }
      console.log(message);
    }

    document.getElementById('openLiffButton').addEventListener('click', function() {
      showStatus('正在初始化 LIFF...');
      if (typeof liff === 'undefined') {
        showStatus('LIFF SDK 未加载，请确保网页已正确加载。', true);
        return;
      }
      liff.init({
        liffId: '2007488640-MVdW20Xe',
        permission: { message: true }
      })
      .then(() => {
        showStatus('LIFF 初始化成功');
      })
      .catch((err) => {
        console.error('LIFF 初始化失败:', err);
        showStatus('LIFF 初始化失败，请确认 LIFF ID 是否正确并已启用', true);
      });
    });
  </script>
</body>
</html>

function calcDaysLeft(expiryDate) {
  if (!expiryDate) return "無資料";

  const expiry = new Date(expiryDate.trim());
  if (isNaN(expiry.getTime())) return "無效日期";

  const now = new Date();

  const expiryDateUTC = new Date(Date.UTC(expiry.getUTCFullYear(), expiry.getUTCMonth(), expiry.getUTCDate()));
  const todayUTC = new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate()));

  const diffDays = Math.floor((expiryDateUTC - todayUTC) / (1000 * 60 * 60 * 24));

  if (diffDays > 0) {
    return `${diffDays} 天`;
  } else if (diffDays === 0) {
    // 同一天，顯示時/分/秒倒數
    const diffMs = expiry.getTime() - now.getTime();

    if (diffMs <= 0) return "已過期";

    const hours = Math.floor(diffMs / (1000 * 60 * 60));
    const minutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((diffMs % (1000 * 60)) / 1000);

    // 補零函數
    const pad = (num) => num.toString().padStart(2, "0");

    return `剩餘 ${pad(hours)}:${pad(minutes)}:${pad(seconds)}`;
  } else {
    return "已過期";
  }
}
